<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 1.8rem;
        }
        
        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-info {
            background-color: var(--info);
            color: white;
        }
        
        .btn-light {
            background-color: var(--light);
            color: var(--dark);
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .card-header {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
        }
        
        .required::after {
            content: " *";
            color: var(--danger);
        }
        
        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }
        
        .col {
            flex: 1;
            padding: 0 10px;
            min-width: 250px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--secondary);
            padding-bottom: 5px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }
        
        .file-upload i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .file-input {
            display: none;
        }
        
        .image-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary);
            margin: 10px auto;
            display: block;
        }
        
        .id-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .id-control input {
            width: 80px;
            text-align: center;
        }
        
        .id-control button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .scroll-buttons {
            position: fixed;
            right: 20px;
            bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .scroll-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .scroll-btn:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
        }
        
        .alert {
            padding: 10px 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .alert-success {
            background-color: rgba(76, 201, 240, 0.2);
            border: 1px solid var(--success);
            color: var(--success);
        }
        
        .alert-danger {
            background-color: rgba(247, 37, 133, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }
        
        .info-text {
            background-color: rgba(72, 149, 239, 0.1);
            border-left: 4px solid var(--info);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 4px 4px 0;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: var(--gray);
            border-top: 1px solid #eaeaea;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .col {
                flex: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-address-book"></i>
                    <h1>Contact Manager</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="active" id="nav-home">Home</a></li>
                        <li><a href="#" id="nav-upload">Upload Contacts</a></li>
                        <li><a href="#" id="nav-template">Download Template</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Main Content -->
        <div id="main-content">
            <div class="info-text">
                <p><strong>Welcome to Contact Manager</strong> - A comprehensive tool to manage your contacts efficiently. 
                You can upload contact data from CSV/Excel files, edit contact information, and export in multiple formats. 
                This application helps you maintain personal, work, and social media information for all your contacts in one place.</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Contact Information</h2>
                </div>
                
                <div class="form-group">
                    <label for="contact-id">Contact ID</label>
                    <div class="id-control">
                        <button class="btn btn-secondary" id="decrease-id"><i class="fas fa-minus"></i></button>
                        <input type="text" id="contact-id" value="1">
                        <button class="btn btn-secondary" id="increase-id"><i class="fas fa-plus"></i></button>
                        <button class="btn btn-info" id="fetch-data"><i class="fas fa-download"></i> Fetch Data from File</button>
                    </div>
                </div>
                
                <div class="section">
                    <h3 class="section-title">Personal Information</h3>
                    
                    <div class="form-group">
                        <label for="profile-image" class="required">Profile Image</label>
                        <div class="file-upload" id="image-upload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload profile image (JPG, JPEG, PNG)</p>
                            <input type="file" id="profile-image" class="file-input" accept=".jpg,.jpeg,.png">
                        </div>
                        <img id="image-preview" class="image-preview hidden" src="#" alt="Profile Image Preview">
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="first-name" class="required">First Name</label>
                                <input type="text" id="first-name" placeholder="Enter first name">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="middle-name">Middle Name</label>
                                <input type="text" id="middle-name" placeholder="Enter middle name">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="last-name">Last Name</label>
                                <input type="text" id="last-name" placeholder="Enter last name">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="nickname">Nickname</label>
                                <input type="text" id="nickname" placeholder="Enter nickname">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="phone-home">Phone Home</label>
                                <input type="text" id="phone-home" placeholder="Enter home phone">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="phone-mobile" class="required">Phone Mobile</label>
                                <input type="text" id="phone-mobile" placeholder="Enter mobile phone">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="Enter email address">
                    </div>
                    
                    <div class="form-group">
                        <label for="dob">Date of Birth</label>
                        <input type="text" id="dob" placeholder="DD-MMM-YYYY (YYYY optional)">
                    </div>
                    
                    <h4 class="section-title">Personal Address</h4>
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="street1">Street 1</label>
                                <input type="text" id="street1" placeholder="Enter street address">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="street2">Street 2</label>
                                <input type="text" id="street2" placeholder="Enter apartment, suite, etc.">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="city">City</label>
                                <input type="text" id="city" placeholder="Enter city">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="zip">ZIP Code</label>
                                <input type="text" id="zip" placeholder="Enter ZIP code">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="home-country">Home Country</label>
                                <select id="home-country">
                                    <option value="">Select Country</option>
                                    <!-- Countries will be populated by JavaScript -->
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3 class="section-title">Work Information</h3>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="company">Company</label>
                                <input type="text" id="company" placeholder="Enter company name">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="department">Department</label>
                                <input type="text" id="department" placeholder="Enter department">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="designation">Designation</label>
                                <input type="text" id="designation" placeholder="Enter designation">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="role">Role</label>
                                <input type="text" id="role" placeholder="Enter role">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="phone-work">Phone Work</label>
                                <input type="text" id="phone-work" placeholder="Enter work phone">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="work-email">Work Email</label>
                                <input type="email" id="work-email" placeholder="Enter work email">
                            </div>
                        </div>
                    </div>
                    
                    <h4 class="section-title">Work Address</h4>
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="work-street1">Street 1</label>
                                <input type="text" id="work-street1" placeholder="Enter street address">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="work-street2">Street 2</label>
                                <input type="text" id="work-street2" placeholder="Enter apartment, suite, etc.">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="work-city">City</label>
                                <input type="text" id="work-city" placeholder="Enter city">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="work-zip">ZIP Code</label>
                                <input type="text" id="work-zip" placeholder="Enter ZIP code">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="work-country">Work Country</label>
                                <select id="work-country">
                                    <option value="">Select Country</option>
                                    <!-- Countries will be populated by JavaScript -->
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="web-address">Web Address</label>
                        <input type="url" id="web-address" placeholder="Enter website URL">
                    </div>
                </div>
                
                <div class="section">
                    <h3 class="section-title">Instant Messaging</h3>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="whatsapp">WhatsApp</label>
                                <input type="text" id="whatsapp" placeholder="Enter WhatsApp">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="wa-business">WA Business</label>
                                <input type="text" id="wa-business" placeholder="Enter WA Business">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="imo">Imo</label>
                                <input type="text" id="imo" placeholder="Enter Imo">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="viber">Viber</label>
                                <input type="text" id="viber" placeholder="Enter Viber">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="twitter">Twitter</label>
                                <input type="text" id="twitter" placeholder="Enter Twitter">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="messenger">Messenger</label>
                                <input type="text" id="messenger" placeholder="Enter Messenger">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="wechat">WeChat</label>
                                <input type="text" id="wechat" placeholder="Enter WeChat">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="telegram">Telegram</label>
                                <input type="text" id="telegram" placeholder="Enter Telegram">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="snapchat">Snapchat</label>
                        <input type="text" id="snapchat" placeholder="Enter Snapchat">
                    </div>
                </div>
                
                <div class="section">
                    <h3 class="section-title">Social Media</h3>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="facebook">Facebook</label>
                                <input type="text" id="facebook" placeholder="Enter Facebook">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="linkedin">LinkedIn</label>
                                <input type="text" id="linkedin" placeholder="Enter LinkedIn">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="instagram">Instagram</label>
                                <input type="text" id="instagram" placeholder="Enter Instagram">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="youtube">YouTube</label>
                                <input type="text" id="youtube" placeholder="Enter YouTube">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="fiverr">Fiverr</label>
                                <input type="text" id="fiverr" placeholder="Enter Fiverr">
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="upwork">Upwork</label>
                                <input type="text" id="upwork" placeholder="Enter Upwork">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="freelancer">Freelancer</label>
                        <input type="text" id="freelancer" placeholder="Enter Freelancer">
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-success" id="save-contact"><i class="fas fa-save"></i> Save Contact</button>
                    <button class="btn btn-primary" id="download-csv"><i class="fas fa-file-csv"></i> Download CSV</button>
                    <button class="btn btn-info" id="download-vcf"><i class="fas fa-file-alt"></i> Download VCF</button>
                    <button class="btn btn-warning" id="download-qr"><i class="fas fa-qrcode"></i> Download QR Code</button>
                    <button class="btn btn-danger" id="clear-form"><i class="fas fa-trash"></i> Clear Form</button>
                </div>
            </div>
        </div>
        
        <!-- Upload Section -->
        <div id="upload-section" class="card hidden">
            <div class="card-header">
                <h2 class="card-title">Upload Contact Data</h2>
            </div>
            
            <div class="form-group">
                <label>Upload CSV or Excel File</label>
                <div class="file-upload" id="file-upload-area">
                    <i class="fas fa-file-upload"></i>
                    <p>Click to upload CSV or Excel file with contact data</p>
                    <input type="file" id="file-input" class="file-input" accept=".csv,.xlsx,.xls">
                </div>
            </div>
            
            <div class="alert alert-info">
                <p><strong>File Format Requirements:</strong></p>
                <ul>
                    <li>File should contain columns for all contact fields</li>
                    <li>First row should contain column headers</li>
                    <li>Use the template for correct formatting</li>
                </ul>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="download-template"><i class="fas fa-download"></i> Download Template</button>
            </div>
        </div>
    </div>

    <div class="scroll-buttons">
        <div class="scroll-btn" id="scroll-top" title="Scroll to Top">
            <i class="fas fa-arrow-up"></i>
        </div>
        <div class="scroll-btn" id="scroll-bottom" title="Scroll to Bottom">
            <i class="fas fa-arrow-down"></i>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2023 Contact Manager. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Country list
        const countries = [
            "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia", 
            "Australia", "Austria", "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", 
            "Belize", "Benin", "Bhutan", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria", 
            "Burkina Faso", "Burundi", "Cabo Verde", "Cambodia", "Cameroon", "Canada", "Central African Republic", "Chad", 
            "Chile", "China", "Colombia", "Comoros", "Congo", "Costa Rica", "Croatia", "Cuba", "Cyprus", "Czech Republic", 
            "Denmark", "Djibouti", "Dominica", "Dominican Republic", "East Timor", "Ecuador", "Egypt", "El Salvador", 
            "Equatorial Guinea", "Eritrea", "Estonia", "Eswatini", "Ethiopia", "Fiji", "Finland", "France", "Gabon", 
            "Gambia", "Georgia", "Germany", "Ghana", "Greece", "Grenada", "Guatemala", "Guinea", "Guinea-Bissau", "Guyana", 
            "Haiti", "Honduras", "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Israel", "Italy", 
            "Jamaica", "Japan", "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Korea, North", "Korea, South", "Kosovo", 
            "Kuwait", "Kyrgyzstan", "Laos", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libya", "Liechtenstein", "Lithuania", 
            "Luxembourg", "Madagascar", "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Mauritania", 
            "Mauritius", "Mexico", "Micronesia", "Moldova", "Monaco", "Mongolia", "Montenegro", "Morocco", "Mozambique", 
            "Myanmar", "Namibia", "Nauru", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", 
            "North Macedonia", "Norway", "Oman", "Pakistan", "Palau", "Palestine", "Panama", "Papua New Guinea", "Paraguay", 
            "Peru", "Philippines", "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saint Kitts and Nevis", 
            "Saint Lucia", "Saint Vincent and the Grenadines", "Samoa", "San Marino", "Sao Tome and Principe", "Saudi Arabia", 
            "Senegal", "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "Solomon Islands", 
            "Somalia", "South Africa", "South Sudan", "Spain", "Sri Lanka", "Sudan", "Suriname", "Sweden", "Switzerland", 
            "Syria", "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Togo", "Tonga", "Trinidad and Tobago", "Tunisia", 
            "Turkey", "Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", 
            "Uruguay", "Uzbekistan", "Vanuatu", "Vatican City", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"
        ];

        // Global variables
        let uploadedData = [];

        // DOM Elements
        const mainContent = document.getElementById('main-content');
        const uploadSection = document.getElementById('upload-section');
        const navHome = document.getElementById('nav-home');
        const navUpload = document.getElementById('nav-upload');
        const navTemplate = document.getElementById('nav-template');
        const contactId = document.getElementById('contact-id');
        const decreaseId = document.getElementById('decrease-id');
        const increaseId = document.getElementById('increase-id');
        const fetchData = document.getElementById('fetch-data');
        const profileImage = document.getElementById('profile-image');
        const imagePreview = document.getElementById('image-preview');
        const imageUpload = document.getElementById('image-upload');
        const homeCountry = document.getElementById('home-country');
        const workCountry = document.getElementById('work-country');
        const fileInput = document.getElementById('file-input');
        const fileUploadArea = document.getElementById('file-upload-area');
        const downloadTemplate = document.getElementById('download-template');
        const saveContact = document.getElementById('save-contact');
        const downloadCsv = document.getElementById('download-csv');
        const downloadVcf = document.getElementById('download-vcf');
        const downloadQr = document.getElementById('download-qr');
        const clearForm = document.getElementById('clear-form');
        const scrollTop = document.getElementById('scroll-top');
        const scrollBottom = document.getElementById('scroll-bottom');

        // Initialize the application
        function init() {
            populateCountries();
            setupEventListeners();
        }

        // Populate country dropdowns
        function populateCountries() {
            countries.forEach(country => {
                const option1 = document.createElement('option');
                option1.value = country;
                option1.textContent = country;
                homeCountry.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = country;
                option2.textContent = country;
                workCountry.appendChild(option2);
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            // Navigation
            navHome.addEventListener('click', () => showSection('main'));
            navUpload.addEventListener('click', () => showSection('upload'));
            navTemplate.addEventListener('click', downloadTemplateFile);
            
            // Contact ID controls
            decreaseId.addEventListener('click', () => changeContactId(-1));
            increaseId.addEventListener('click', () => changeContactId(1));
            fetchData.addEventListener('click', fetchDataFromFile);
            
            // Image upload
            imageUpload.addEventListener('click', () => profileImage.click());
            profileImage.addEventListener('change', handleImageUpload);
            
            // File upload
            fileUploadArea.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileUpload);
            downloadTemplate.addEventListener('click', downloadTemplateFile);
            
            // Form actions
            saveContact.addEventListener('click', saveContactData);
            downloadCsv.addEventListener('click', downloadCsvFile);
            downloadVcf.addEventListener('click', downloadVcfFile);
            downloadQr.addEventListener('click', downloadQrCode);
            clearForm.addEventListener('click', clearFormData);
            
            // Scroll buttons
            scrollTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
            scrollBottom.addEventListener('click', () => window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }));
        }

        // Navigation functions
        function showSection(section) {
            if (section === 'main') {
                mainContent.classList.remove('hidden');
                uploadSection.classList.add('hidden');
                navHome.classList.add('active');
                navUpload.classList.remove('active');
            } else if (section === 'upload') {
                mainContent.classList.add('hidden');
                uploadSection.classList.remove('hidden');
                navHome.classList.remove('active');
                navUpload.classList.add('active');
            }
        }

        // Contact ID functions
        function changeContactId(delta) {
            let currentId = parseInt(contactId.value) || 1;
            currentId += delta;
            if (currentId < 1) currentId = 1;
            contactId.value = currentId;
        }

        function fetchDataFromFile() {
            const id = parseInt(contactId.value) || 1;
            
            if (uploadedData.length === 0) {
                alert('Please upload a file first');
                return;
            }
            
            // Find contact with matching ID
            const contact = uploadedData.find(item => item.id === id);
            
            if (!contact) {
                alert(`No contact found with ID ${id}`);
                return;
            }
            
            // Populate form with contact data
            Object.keys(contact).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = contact[key] || '';
                }
            });
            
            // Handle image if present
            if (contact.imageBase64) {
                imagePreview.src = contact.imageBase64;
                imagePreview.classList.remove('hidden');
            }
            
            alert(`Contact data loaded for ID ${id}`);
        }

        // Image upload function
        function handleImageUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Check file type
            if (!file.type.match('image/jpeg') && !file.type.match('image/jpg') && !file.type.match('image/png')) {
                alert('Please upload a valid image file (JPG, JPEG, PNG)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(event) {
                imagePreview.src = event.target.result;
                imagePreview.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        // File upload function
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    // Check if it's a CSV or Excel file
                    if (file.name.endsWith('.csv')) {
                        // Parse CSV
                        const csvData = event.target.result;
                        const lines = csvData.split('\n');
                        const headers = lines[0].split(',');
                        
                        uploadedData = [];
                        for (let i = 1; i < lines.length; i++) {
                            if (lines[i].trim() === '') continue;
                            
                            const obj = {};
                            const currentLine = lines[i].split(',');
                            
                            for (let j = 0; j < headers.length; j++) {
                                obj[headers[j].trim()] = currentLine[j] ? currentLine[j].trim() : '';
                            }
                            
                            uploadedData.push(obj);
                        }
                    } else {
                        // Parse Excel
                        const data = new Uint8Array(event.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        // Get first worksheet
                        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                        
                        // Convert to JSON
                        uploadedData = XLSX.utils.sheet_to_json(worksheet);
                    }
                    
                    alert(`Successfully uploaded ${uploadedData.length} contacts`);
                } catch (error) {
                    console.error('Error parsing file:', error);
                    alert('Error parsing file. Please check the format.');
                }
            };
            
            if (file.name.endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }

        // Template download function
        function downloadTemplateFile() {
            // Create template data
            const templateData = [
                {
                    id: 1,
                    firstName: "John",
                    middleName: "Michael",
                    lastName: "Doe",
                    nickname: "Johnny",
                    phoneHome: "123-456-7890",
                    phoneMobile: "987-654-3210",
                    email: "john.doe@example.com",
                    dob: "15-Jan-1985",
                    street1: "123 Main St",
                    street2: "Apt 4B",
                    city: "New York",
                    zip: "10001",
                    homeCountry: "United States",
                    company: "Tech Corp",
                    department: "Engineering",
                    designation: "Senior Developer",
                    role: "Team Lead",
                    phoneWork: "555-123-4567",
                    workEmail: "john.doe@techcorp.com",
                    workStreet1: "456 Business Ave",
                    workStreet2: "Suite 300",
                    workCity: "New York",
                    workZip: "10002",
                    workCountry: "United States",
                    webAddress: "https://johndoe.com",
                    whatsapp: "9876543210",
                    waBusiness: "9876543210",
                    imo: "john.doe",
                    viber: "john.doe",
                    twitter: "@johndoe",
                    messenger: "john.doe",
                    wechat: "john_doe",
                    telegram: "@johndoe",
                    snapchat: "john_doe",
                    facebook: "john.doe",
                    linkedin: "john-doe",
                    instagram: "@johndoe",
                    youtube: "johndoe",
                    fiverr: "johndoe",
                    upwork: "john_doe",
                    freelancer: "john_doe"
                }
            ];
            
            // Create worksheet
            const worksheet = XLSX.utils.json_to_sheet(templateData);
            
            // Create workbook
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Contacts");
            
            // Generate file and download
            XLSX.writeFile(workbook, "contact_template.xlsx");
        }

        // Form actions
        function saveContactData() {
            // Validate required fields
            if (!validateRequiredFields()) {
                alert('Please fill in all required fields');
                return;
            }
            
            // In a real app, this would save to a database
            alert('Contact saved successfully!');
        }

        function validateRequiredFields() {
            const requiredFields = [
                'first-name', 'phone-mobile'
            ];
            
            for (const fieldId of requiredFields) {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.focus();
                    return false;
                }
            }
            
            // Check if image is uploaded
            if (!imagePreview.src || imagePreview.src === '#' || imagePreview.classList.contains('hidden')) {
                alert('Please upload a profile image');
                return false;
            }
            
            return true;
        }

        function downloadCsvFile() {
            if (!validateRequiredFields()) {
                alert('Please fill in all required fields before downloading');
                return;
            }
            
            const contactData = getFormData();
            const headers = Object.keys(contactData);
            const csvContent = [
                headers.join(','), // Header row
                headers.map(header => contactData[header]).join(',') // Data row
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${contactData.firstName}_${contactData.lastName}_${contactData.phoneMobile}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function downloadVcfFile() {
            if (!validateRequiredFields()) {
                alert('Please fill in all required fields before downloading');
                return;
            }
            
            const contactData = getFormData();
            const vcfContent = generateVcf(contactData);
            
            const blob = new Blob([vcfContent], { type: 'text/vcard' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${contactData.firstName}_${contactData.lastName}_${contactData.phoneMobile}.vcf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function downloadQrCode() {
            if (!validateRequiredFields()) {
                alert('Please fill in all required fields before downloading');
                return;
            }
            
            const contactData = getFormData();
            const vcfContent = generateVcf(contactData);
            
            // Generate QR code
            const qr = qrcode(0, 'M');
            qr.addData(vcfContent);
            qr.make();
            
            const qrSvg = qr.createSvgTag(4);
            const svgBlob = new Blob([qrSvg], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(svgBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${contactData.firstName}_${contactData.lastName}_${contactData.phoneMobile}.svg`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function clearFormData() {
            if (confirm('Are you sure you want to clear all form data?')) {
                const formElements = document.querySelectorAll('input, select, textarea');
                formElements.forEach(element => {
                    if (element.id !== 'contact-id') {
                        element.value = '';
                    }
                });
                imagePreview.src = '#';
                imagePreview.classList.add('hidden');
                contactId.value = '1';
            }
        }

        // Helper functions
        function getFormData() {
            const data = {};
            const inputs = document.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                if (input.id && input.id !== 'profile-image' && input.id !== 'file-input') {
                    data[input.id] = input.value;
                }
            });
            
            // Add image if available
            if (imagePreview.src && imagePreview.src !== '#' && !imagePreview.classList.contains('hidden')) {
                data.imageBase64 = imagePreview.src;
            }
            
            return data;
        }

        function generateVcf(contactData) {
            let vcf = 'BEGIN:VCARD\n';
            vcf += 'VERSION:3.0\n';
            vcf += `FN:${contactData.firstName} ${contactData.middleName || ''} ${contactData.lastName || ''}\n`;
            vcf += `N:${contactData.lastName || ''};${contactData.firstName};${contactData.middleName || ''};;\n`;
            
            if (contactData.nickname) vcf += `NICKNAME:${contactData.nickname}\n`;
            if (contactData.phoneHome) vcf += `TEL;TYPE=HOME:${contactData.phoneHome}\n`;
            if (contactData.phoneMobile) vcf += `TEL;TYPE=CELL:${contactData.phoneMobile}\n`;
            if (contactData.phoneWork) vcf += `TEL;TYPE=WORK:${contactData.phoneWork}\n`;
            if (contactData.email) vcf += `EMAIL;TYPE=HOME:${contactData.email}\n`;
            if (contactData.workEmail) vcf += `EMAIL;TYPE=WORK:${contactData.workEmail}\n`;
            
            if (contactData.dob) vcf += `BDAY:${contactData.dob}\n`;
            
            // Personal address
            if (contactData.street1 || contactData.city || contactData.zip || contactData.homeCountry) {
                vcf += `ADR;TYPE=HOME:;;${contactData.street1 || ''};${contactData.city || ''};;${contactData.zip || ''};${contactData.homeCountry || ''}\n`;
            }
            
            // Work address
            if (contactData.workStreet1 || contactData.workCity || contactData.workZip || contactData.workCountry) {
                vcf += `ADR;TYPE=WORK:;;${contactData.workStreet1 || ''};${contactData.workCity || ''};;${contactData.workZip || ''};${contactData.workCountry || ''}\n`;
            }
            
            if (contactData.company) vcf += `ORG:${contactData.company}\n`;
            if (contactData.designation) vcf += `TITLE:${contactData.designation}\n`;
            if (contactData.webAddress) vcf += `URL:${contactData.webAddress}\n`;
            
            // Social media and messaging
            if (contactData.facebook) vcf += `X-SOCIALPROFILE;TYPE=facebook:${contactData.facebook}\n`;
            if (contactData.linkedin) vcf += `X-SOCIALPROFILE;TYPE=linkedin:${contactData.linkedin}\n`;
            if (contactData.twitter) vcf += `X-SOCIALPROFILE;TYPE=twitter:${contactData.twitter}\n`;
            if (contactData.instagram) vcf += `X-SOCIALPROFILE;TYPE=instagram:${contactData.instagram}\n`;
            if (contactData.whatsapp) vcf += `X-SOCIALPROFILE;TYPE=whatsapp:${contactData.whatsapp}\n`;
            if (contactData.telegram) vcf += `X-SOCIALPROFILE;TYPE=telegram:${contactData.telegram}\n`;
            
            // Photo if available
            if (contactData.imageBase64) {
                vcf += `PHOTO;ENCODING=B;TYPE=JPEG:${contactData.imageBase64.split(',')[1]}\n`;
            }
            
            vcf += 'END:VCARD\n';
            return vcf;
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>